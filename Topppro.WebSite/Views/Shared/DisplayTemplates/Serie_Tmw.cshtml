@using Topppro.WebSite.Resources
@using Topppro.WebSite.Extensions
@using Framework.Common.Extensions

@model Topppro.Entities.Serie
           
@{
    ViewBag.MaxPerLine = 4;
}

@Html.Separator()

<tr>
    <td width="55">
        &nbsp;
    </td>
    <td colspan="9">
        <img src="@Url.Content("~/Content/Images/tmw-series-spacer.png")" alt="@Model.Name.ToUpper() SERIES" width="881" height="43" />
    </td>
    <td width="55">
        &nbsp;
    </td>
</tr>

@Html.Separator()
@Html.Pattern()

@if (!Model.Products.IsEmpty())
{
<tr>
    <td>&nbsp;</td>
    @foreach (var product in Model.Products.Where(p => p.Enabled).OrderBy(p => p.Priority))
    {
        if (Model.Products.Where(p => p.Enabled).OrderBy(p => p.Priority).ToList().IndexOf(product) != 0
            && (Model.Products.Where(p => p.Enabled).OrderBy(p => p.Priority).ToList().IndexOf(product) % ViewBag.MaxPerLine) == 0)
        {
            @:</tr>
            @Html.Separator()
            @:<tr>
                <td>&nbsp;</td>
        }
    
        <td @(product.Id == 122 ? "colspan=3" : "")>
            <table cellpadding="0" cellspacing="0" width="100%">
                <tr>
                    <td colspan="3" align="left">
                        @if (product.GetThumbs().IsEmpty())
                        {
                        <img src="@Url.Content("~/Content/Images/coming-soon.jpg")" alt="@product.Name" name="@(string.Format("Image{0}", product.Id))"
                            width="148" height="148" border="0" id="@(string.Format("Image{0}", product.Id))" />
                        }
                        else
                        {
                            <a href="@Url.RouteUrl("Detail", new { controller = ViewContext.RouteData.Values["controller"], id = product.Id, name = product.Name.ToSeoSlug() })" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('@(string.Format("Image{0}", product.Id))','','@(product.GetThumbs().Where(t => t.Contains("up")).DefaultIfEmpty<string>(Url.Content("~/Content/Images/coming-soon.jpg")).First())',1)">
                                <img src="@(product.GetThumbs().Where(t => !t.Contains("up")).DefaultIfEmpty<string>(Url.Content("~/Content/Images/coming-soon.jpg")).First())" alt="@product.Name" name="@(string.Format("Image{0}", product.Id))"
                                    @(product.Id != 122 ? "width=148" : "") height="148" border="0" id="@(string.Format("Image{0}", product.Id))" />
                            </a>
                        }
                    </td>
                </tr>
                <tr>
                    <td>
                        <img src="@Url.Content("~/Content/Images/middle1-separator.png")" width="1" height="24" alt="spacer" />
                    </td>
                    <td align="center">
                        @{
                        var name = product.Name.Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries).ToList();
                        name.Insert(2, "<br/>");
                        }
                        <span class="Estilo6">@Html.Raw(string.Join(" ", name))</span>
                    </td>
                    <td>
                        &nbsp;
                    </td>
                </tr>
                <tr>
                    <td>
                        &nbsp;
                    </td>
                    <td align="center" height="20px">
                        <input type="checkbox" id="@product.Folder" value="@product.Id" data-text="@product.Name.ToSeoSlug()" />
                        <label for="@product.Folder">@Localization.Add_To_Compare</label>
                    </td>
                    <td>
                        &nbsp;
                    </td>
                </tr>
            </table>
        </td>
        <td>&nbsp;</td>
    }
</tr>
}
